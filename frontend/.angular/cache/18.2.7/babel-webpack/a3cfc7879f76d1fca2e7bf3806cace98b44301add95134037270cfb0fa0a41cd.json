{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport let CartService = /*#__PURE__*/(() => {\n  class CartService {\n    constructor() {\n      this.items = [];\n      this.items$ = new BehaviorSubject([]);\n      this.cart$ = this.items$.asObservable();\n      this.load();\n    }\n    emit() {\n      this.items$.next([...this.items]);\n      this.save();\n    }\n    add(item) {\n      // добавить qty по умолчанию\n      const idx = this.items.findIndex(i => i.id === item.id);\n      if (idx > -1) {\n        this.items[idx].qty = (this.items[idx].qty || 1) + 1;\n      } else {\n        this.items.push({\n          ...item,\n          qty: 1\n        });\n      }\n      this.emit();\n    }\n    remove(itemId) {\n      this.items = this.items.filter(i => i.id !== itemId);\n      this.emit();\n    }\n    updateQty(itemId, qty) {\n      const idx = this.items.findIndex(i => i.id === itemId);\n      if (idx > -1) {\n        this.items[idx].qty = Math.max(1, qty);\n        this.emit();\n      }\n    }\n    clear() {\n      this.items = [];\n      this.emit();\n    }\n    total() {\n      return this.items.reduce((s, i) => s + (i.price || 0) * (i.qty || 1), 0);\n    }\n    getItems() {\n      return [...this.items];\n    }\n    load() {\n      try {\n        const raw = localStorage.getItem('cart_v1');\n        this.items = raw ? JSON.parse(raw) : [];\n        this.items$.next([...this.items]);\n      } catch {\n        this.items = [];\n      }\n    }\n    save() {\n      localStorage.setItem('cart_v1', JSON.stringify(this.items));\n    }\n    static {\n      this.ɵfac = function CartService_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || CartService)();\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: CartService,\n        factory: CartService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return CartService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}